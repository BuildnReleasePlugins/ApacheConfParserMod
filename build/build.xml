<?xml version="1.0"?>
<project name="ApacheConfParser" default="jar" basedir=".">
	
	<loadproperties srcFile="build.properties"/> 
	
	<property name="doc.dir"     value="../doc"/>
	<property name="source.dir"     value="../src"/>
    <property name="lib.dir"        value="../lib"/>
    <property name="class.dir"      value="classes"/>
    <property name="jar.dir"        value="../dist"/>
    <property name="jar.file"        value="${jar.dir}/${ant.project.name}-${version}.jar"/>
    <property name="main-class"     value="apache.conf.parser.Main"/>

    <path id="libraries.path">    
        <fileset dir="${lib.dir}">
            <include name="*.jar"/>
        </fileset>
    </path>

    <target name="clean" description="delete old files">
        <delete dir="${class.dir}"/>
    </target>

    <target name="compile" description="build class files" depends="clean">
        <mkdir dir="${class.dir}"/>
        <javac srcdir="${source.dir}" destdir="${class.dir}">
            <classpath refid="libraries.path"/>
        </javac>
    </target>

    <target name="jar" depends="compile">
    	
    	<mkdir dir="${jar.dir}"/>
        <mkdir dir="${class.dir}/lib"/>
        <copy todir="${class.dir}/lib" flatten="true">
            <path refid="libraries.path"/>
        </copy>

        <manifestclasspath property="manifest.classpath" jarfile="${jar.file}">
            <classpath refid="libraries.path"/>
        </manifestclasspath>

        <jar destfile="${jar.file}" basedir="${class.dir}">
            <manifest>
                <attribute name="Main-Class" value="${main-class}"/>
                <attribute name="Class-Path" value="${manifest.classpath}"/>
            </manifest>
        </jar>  
    </target>

    <target name="run" depends="jar">
        <java jar="${jar.file}" fork="true"/>
    </target>
	
	<target name="javadoc">
        
		<delete dir="${doc.dir}"/>
		
		<javadoc 
        	access="public" 
        	author="true" 
        	classpath="." 
        	destdir="${doc.dir}" 
        	nodeprecated="false" 
        	nodeprecatedlist="false" 
        	noindex="false" 
        	nonavbar="false" 
        	notree="false" 
        	packagenames="apache.conf.modules" 
        	source="1.6" 
        	sourcefiles="${source.dir}/apache/conf/parser/File.java,${source.dir}/apache/conf/parser/Directive.java,${source.dir}/apache/conf/parser/Enclosure.java,${source.dir}/apache/conf/parser/DirectiveParser.java,${source.dir}/apache/conf/parser/ParsableLine.java,${source.dir}/apache/conf/parser/EnclosureParser.java,${source.dir}/apache/conf/parser/Parser.java" 
        	sourcepath="${source.dir}" 
        	splitindex="true" 
        	use="true" 
        	version="true"/>
    </target>
</project>
